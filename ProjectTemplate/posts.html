<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Virtual Suggestion Box</title>
    <!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!!-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
    <script type="text/javascript">


        //Global variable used to store information about posts we're trying to edit and pass onto another function that can't easily handle it
        uID = -1;
        postID = 0;
        description = "";
        getID();
        IsUser();
        editUserID = 0;



        //logs the user off both at the client and at the server
        function LogOff() {
            var webMethod = "ProjectServices.asmx/LogOff";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        //we logged off, so go back to logon page,
                        //stop checking messages
                        //and clear the chat panel
                        window.open("index.html", "_self")
                        HideMenu();
                    }
                    else {
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        function getID() {
            var webMethod = "ProjectServices.asmx/GetID";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d > 0) {
                        uID = msg.d;
                    }

                },
            });
        }

        //an ajax to check if the user is an admin
        function CheckAdmin() {
            var webMethod = "ProjectServices.asmx/IsAdmin";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        ShowMenu();
                        //alert("Admin");
                    }
                    else {
                        //alert("Not an Admin");
                    }

                },
            });
        }

    
        //an ajax to check if the user is an admin
        function IsUser() {
            var webMethod = "ProjectServices.asmx/IsUser";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {

                    }
                    else {
                        alert("Unauthorized Access:");
                        window.open("index.html", "_self")
                    }

                },
            });
        }

        //passes account info to the server, to create an account request
        function NewSuggestion(desc, category) {
            var webMethod = "ProjectServices.asmx/NewSuggestion";
            var parameters = "{\"desc\":\"" + encodeURI(desc) + "\",\"category\":\"" + encodeURI(category) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("Suggestion pending approval by admins. You'll receive a notification when it has been reviewed. ");
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }


        //an ajax to deny a suggestion which will remove it from the database
        function DenySuggestion(id) {
            var webMethod = "ProjectServices.asmx/DenySuggestion";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    LoadUnapprovedSuggestions()
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //an ajax to delete a suggestion post. Prompts the user to be sure
        function DeleteSuggestion(id) {
            var webMethod = "ProjectServices.asmx/DenySuggestion";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";
            let confirmation;
            if (confirm("Are you sure you want to delete the suggestion?") == true) {
                text = "Deleting Post";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        ManageSuggestions()
                    },
                    error: function (e) {
                        alert("boo...");
                    }
                });
            } else {
                text = "Deletion cancelled";
            }


        }

        //an ajax to approve a suggestion
        function ApproveSuggestion(id) {
            var webMethod = "ProjectServices.asmx/ApproveSuggestion";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    LoadUnapprovedSuggestions();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //this function grabs all the unapproved suggestions and displays them
        function LoadUnapprovedSuggestions() {
            var webMethod = "ProjectServices.asmx/GetUnapprovedSuggestions";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        suggestionsArray = msg.d;
                        $("#suggestionsBox").empty();
                        middlePanelTitle.innerText = "Review Suggestions";
                        admin = false;
                        document.getElementById('topPost').style.visibility = 'hidden';
                        $('#editAccountPanel').css("visibility", "hidden");
                        for (var i = 0; i < suggestionsArray.length; i++) {
                            var suggestion;

                            suggestion = "<div class='suggestionRow'w id='suggestion'><button onclick=\"ApproveSuggestion(" + suggestionsArray[i].id + ")\">Approve</button><button onclick=\"DenySuggestion(" +
                                suggestionsArray[i].id + ")\">Deny</button> <b>Category: </b> " + suggestionsArray[i].category + " <b> Details:</b> " +
                                suggestionsArray[i].desc + "</div><br><br>"
                            $("#suggestionsBox").append(
                                suggestion
                            );
                        }
                    }
                    else {
                        message = "No suggestions to approve"
                        $("#unapprovedSuggestionsBox").append(
                            message
                        );

                    }
                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }

        //this function Loads all the suggestions with some editing options
        function ManageSuggestions() {
            var webMethod = "ProjectServices.asmx/LoadSuggestions";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        suggestionsArray = msg.d;
                        //Clears the box
                        $("#suggestionsBox").empty();
                        admin = false;
                        middlePanelTitle.innerText = "Manage Suggestions";
                        document.getElementById('topPost').style.visibility = 'hidden';
                        $('#editAccountPanel').css("visibility", "hidden");
                        for (var i = 0; i < suggestionsArray.length; i++) {
                            var suggestion;

                            suggestion = "<div class='suggestionRow'w id='suggestion'><button id=\"deleteBut" + i + "\" onclick=\"DeleteSuggestion(" +
                                suggestionsArray[i].id + ", " + i + ")\">Delete</button><button id=\"editBut" + i + "\" onclick=\"EditSuggestion(" + suggestionsArray[i].id +
                                ", \'" + suggestionsArray[i].desc + "\', \'" + suggestionsArray[i].status + "\', \'" + suggestionsArray[i].category + "\')\">Edit</button> <b>Status: </b> " +
                                suggestionsArray[i].status + " <b>Category: </b> " + suggestionsArray[i].category +
                                " <b> Details:</b> " + suggestionsArray[i].desc + "</div><br><br>"
                            $("#suggestionsBox").append(
                                suggestion
                            );
                        }
                    }
                    else {
                        message = "No suggestions to approve"
                        $("#unapprovedSuggestionsBox").append(
                            message
                        );

                    }
                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }

        //this function grabs all the approved suggestions and displays them
        function LoadSuggestions() {
            var webMethod = "ProjectServices.asmx/LoadSuggestions";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        suggestionsArray = msg.d;
                        //getID();
                        //this clears out the div that will hold our suggestion info. Not sure if this is in use any more.
                        $("#suggestionsBox").empty();
                        middlePanelTitle.innerText = "Current Suggestions";
                        likedAlready = false;
                        document.getElementById('topPost').style.visibility = 'visible';
                        $('#editAccountPanel').css("visibility", "hidden");

                        for (var i = 0; i < suggestionsArray.length; i++) {
                            var suggestion;
                            stringToCompare = "#" + uID + "#";
                            stringToCheck = suggestionsArray[i].usersLiked;
                            likedAlready = stringToCheck.includes(stringToCompare);

                            if (likedAlready == false) {
                                suggestion = "<div class=\"suggestionRow\" id=\"suggestion\"> <div class=\"postCat\">" + suggestionsArray[i].category +
                                    "</div> <div class=\"postDetails\">" + suggestionsArray[i].desc + "</div> <button class=\"upvote\" id=\"postHeart" +
                                    i + "\" onClick=\"LikePost('" + suggestionsArray[i].id + "', '" + suggestionsArray[i].usersLiked + "')\">&#9825</button> <span class=\"postLikes\" id=\"postLikes" + i +
                                    "\">" + suggestionsArray[i].likeCount + "</span></div>"
                                $("#suggestionsBox").append(
                                    suggestion
                                );
                            }
                            else {
                                suggestion = "<div class=\"suggestionRow\" id=\"suggestion\"> <div class=\"postCat\">" + suggestionsArray[i].category +
                                    "</div> <div class=\"postDetails\">" + suggestionsArray[i].desc + "</div> <button class=\"upvote\" id=\"postHeart" +
                                    i + "\" onClick=\"UnlikePost('" + suggestionsArray[i].id + "', '" + suggestionsArray[i].usersLiked + "')\">&#10084</button> <span class=\"postLikes\" id=\"postLikes" + i +
                                    "\">" + suggestionsArray[i].likeCount + "</span></div>"
                                $("#suggestionsBox").append(
                                    suggestion
                                )
                            }
                        }

                    }
                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }

        //This function is for letting users click the like button, and unclick it
        function LikePost(postid, users) {
            var webMethod = "ProjectServices.asmx/LikeSuggestion";
            var parameters = "{\"postId\":\"" + encodeURI(postid) + "\",\"users\":\"" + encodeURI(users) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    LoadSuggestions();
                },
                error: function (e) {
                    alert("Failed to Like message: "+ e); 
                }
            });

        }


        //this function loads the suggestions based on the filter
        function FilterSuggestions(filter) {
            var webMethod = "ProjectServices.asmx/FilterSuggestions";
            var parameters = "{\"filter\":\"" + encodeURI(filter) + "\"}";

            $('#editAccountPanel').css("visibility", "hidden");
            document.getElementById('topPost').style.visibility = 'hidden';

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    likedAlready = false;
                    if (msg.d.length > 0) {
                        suggestionsArray = msg.d;
                        //this clears out the div that will hold our suggestion info. Not sure if this is in use any more.
                        $("#suggestionsBox").empty();
                        middlePanelTitle.innerText = filter + " Suggestions";

                        for (var i = 0; i < suggestionsArray.length; i++) {
                            var suggestion;

                            stringToCompare = "#" + uID + "#";
                            stringToCheck = suggestionsArray[i].usersLiked;
                            likedAlready = stringToCheck.includes(stringToCompare);

                            if (likedAlready == false) {
                                suggestion = "<div class=\"suggestionRow\" id=\"suggestion\"> <div class=\"postCat\">" + suggestionsArray[i].category +
                                    "</div> <div class=\"postDetails\">" + suggestionsArray[i].desc + "</div> <button class=\"upvote\" id=\"postHeart" +
                                    i + "\" onClick=\"LikePost('" + suggestionsArray[i].id + "', '" + suggestionsArray[i].usersLiked + "')\">&#9825</button> <span class=\"postLikes\" id=\"postLikes" + i +
                                    "\">" + suggestionsArray[i].likeCount + "</span></div>"
                                $("#suggestionsBox").append(
                                    suggestion
                                );
                            }
                            else {
                                suggestion = "<div class=\"suggestionRow\" id=\"suggestion\"> <div class=\"postCat\">" + suggestionsArray[i].category +
                                    "</div> <div class=\"postDetails\">" + suggestionsArray[i].desc + "</div> <button class=\"upvote\" id=\"postHeart" +
                                    i + "\" onClick=\"UnlikePost('" + suggestionsArray[i].id + "', '" + suggestionsArray[i].usersLiked + "')\">&#10084</button> <span class=\"postLikes\" id=\"postLikes" + i +
                                    "\">" + suggestionsArray[i].likeCount + "</span></div>"
                                $("#suggestionsBox").append(
                                    suggestion
                                )
                            }
                        }
                    }
                    else {
                        $("#suggestionsBox").empty();
                        var message = "<div class='suggestionRow' id='suggestion'>No suggestions</div><br><br>"
                        $("#suggestionsBox").append(
                            message
                        );

                    }
                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }

        //Taking parameters from the post we want to edit and passing them into our pop-up form.
        function EditSuggestion(id, desc, status, category) {
            paremeters = id + ", " + desc + ", " + status + ", " + category;
            paremeters = id + ", " + desc + ", " + status + ", " + category;admin
            postID = id;
            description = desc
            OpenForm()
        }

        //Taking the parameters passed from the pop-up form and sending them to be inserted into the table.
        //If there was no description entered - it will use the decscription saved in the global variable from the 
        //EditSuggestion function - so that we don't accidentally save a blank field. 
        function SaveEdits(desc, category, status, id) {
            if (desc == "") {
                desc = description
            };
            paremeters = id + ", " + desc + ", " + status + ", " + category;
            var webMethod = "ProjectServices.asmx/EditSuggestion";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\",\"status\":\"" +
                encodeURI(status) + "\",\"desc\":\"" + encodeURI(desc) + "\",\"category\":\"" + encodeURI(category) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("Edit Saved");
                    CloseForm()
                    description = "";
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        // Functions for opening a pop-up form for editing a suggestion
        function OpenForm() {
            document.getElementById("myForm").style.display = "block";
        }

        // Functions for closing a pop-up form for editing a suggestion
        function CloseForm() {
            document.getElementById("myForm").style.display = "none";
        } 

        //this function grabs all the user accounts and displays them
        function LoadAccounts() {
            var webMethod = "ProjectServices.asmx/LoadAccounts";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {

                    if (msg.d.length > 0) {
                        accountsArray = msg.d;
                        //this clears out the div that will hold our suggestion info. Not sure if this is in use any more.
                        $("#suggestionsBox").empty();
                        middlePanelTitle.innerText = "Manage Accounts";
                        admin = false;
                        document.getElementById('topPost').style.visibility = 'hidden';
                        $('#editAccountPanel').css("visibility", "hidden");

                        for (var i = 0; i < accountsArray.length; i++) {
                            var account;
                            var status = ' Active';

                            if (accountsArray[i].active == '1') {

                                account = "<div class='suggestionRow' id='account'><button onclick=\"EditAccount("
                                    + accountsArray[i].id +
                                    ")\">Edit</button>  <b>First Name </b> "
                                    + accountsArray[i].firstName + " <b>Last Name:</b> " + accountsArray[i].lastName + " <b> Username: </b> " + accountsArray[i].userName + " <b>Status:</b>" +
                                    status + "<button style=\"float: right;\" onclick=\"DeactivateAccount(" + accountsArray[i].id + ")\">Deactivate</button></div > <br><br>"
                                $("#suggestionsBox").append(
                                    account
                                );
                            }
                            else {
                                status = ' Inactive';
                                account = "<div class='suggestionRow' id='account'><button onclick=\"ActivateAccount(" + accountsArray[i].id + ")\">Activate</button> <b>First Name </b> "
                                    + accountsArray[i].firstName + " <b>Last Name:</b> " + accountsArray[i].lastName + " <b> Username: </b> " + accountsArray[i].userName + " <b>Status:</b>" +
                                    status + "</div><br><br>"
                                $("#suggestionsBox").append(
                                    account
                                );
                            }
                        }

                    }

                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }  

        //this function grabs all the unapproved accounts and displays them
        function LoadUnapprovedAccounts() {
            var webMethod = "ProjectServices.asmx/GetUnapprovedAccounts";
            $('#editAccountPanel').css("visibility", "hidden");
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {

                    if (msg.d.length > 0) {
                        accountsArray = msg.d;
                        //this clears out the div that will hold our suggestion info. Not sure if this is in use any more.
                        $("#suggestionsBox").empty();
                        middlePanelTitle.innerText = "Review Accounts";
                        admin = false;
                        for (var i = 0; i < accountsArray.length; i++) {
                            var account;

                            account = "<div class='suggestionRow' id='account'><button onclick=\"ApproveAccount(" + accountsArray[i].id + ")\">Approve</button><button onclick=\"DenyAccount(" +
                                accountsArray[i].id + ")\">Deny</button> <b>First Name </b> " + accountsArray[i].firstName + " <b>Last Name:</b> " +
                                accountsArray[i].lastName + " <b> Username: </b> " + accountsArray[i].userName + "</div><br><br>"
                            $("#suggestionsBox").append(
                                account
                            );
                        }

                    }
                    else {
                        message = "No accounts to approve"
                        $("#unapprovedSuggestionsBox").append(
                            message
                        );

                    }

                },
                error: function (e) {
                    alert("Something unexpected happened. You've been eaten by a grue.");
                }
            });
        }        


        //an ajax to deny an account request
        function DenyAccount(id) {
            var webMethod = "ProjectServices.asmx/DenyAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    LoadUnapprovedAccounts()
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //an ajax to approve an account request
        function ApproveAccount(id) {
            var webMethod = "ProjectServices.asmx/ApproveAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("Approved")
                    LoadUnapprovedAccounts();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //an ajax to approve an account request
        function UnlockAccount() {
            alert(editUserID);
            var webMethod = "ProjectServices.asmx/UnlockAccount";
            var parameters = "{\"userId\":\"" + encodeURI(editUserID) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("Account Unlocked")
                    $('#editLockedOut').val('No');
                },
                error: function (e) {
                    alert("Account Not Unlocked");

                }
            });
        }

        function DeactivateAccount(id) {

            if (confirm('Are you sure you want to delete this account?') == true) {
                var webMethod = "ProjectServices.asmx/DeactivateAccount";
                var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        LoadAccounts()
                    },
                    error: function (e) {
                        alert("boo...");
                    }
                });
            }

        }

        function ActivateAccount(id) {

            if (confirm('Are you sure you want to activate this account?') == true) {
                var webMethod = "ProjectServices.asmx/ActivateAccount";
                var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        LoadAccounts()
                    },
                    error: function (e) {
                        alert("boo...");
                    }
                });
            }

        }

        // edit account
        function EditAccount(id) {
            var webMethod = "ProjectServices.asmx/GetAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    $("#suggestionsBox").empty();
                    middlePanelTitle.innerText = "Edit Account";
                    admin = false;
                    document.getElementById('topPost').style.visibility = 'hidden';
                    $('#editAccountPanel').css("visibility", "visible");

                    if (msg.d.length > 0) {
                        account = msg.d;
                        for (var i = 0; i < account.length; i++) {
                            editUserID = account[i].id;
                            var fName = account[i].firstName;
                            var lName = account[i].lastName;
                            var uName = account[i].userName;
                            var eAdd = account[i].emailAddress;
                            var secQ = account[i].secQuestion;
                            var secA = account[i].secAnswer;
                            var pw = account[i].password;
                            var isadmin;
                            var isLockedOut;
                            if (account[i].admin == 1) {
                                isadmin = 'Yes';

                            }
                            else {
                                isadmin = 'No';
                            }
                            if (account[i].lockedOut == 1) {
                                isLockedOut = 'Yes'
                            }
                            else {
                                isLockedOut = 'No'
                            }



                            $('#accountID').val(id);
                            $('#editLogonId').val(uName);
                            $('#editLogonPassword').val(pw);
                            $('#editLogonFName').val(fName);
                            $('#editLogonLName').val(lName);
                            $('#editLogonEmail').val(eAdd);
                            $('#currentSecQ').val(secQ);
                            $('#editSecAnswer').val(secA);
                            $('#editAdmin').val(isadmin);
                            $('#editLockedOut').val(isLockedOut);
                            $('#currentSecQ').attr('readonly', true);
                        }
                    }

                },
                error: function (e) {
                    alert("An error has occurred.");
                }
            });


        }

        // save account updates
        function UpdateAccount() {
            var id = document.getElementById('accountID').value;
            var userName = document.getElementById('editLogonId').value;
            var pwd = document.getElementById('editLogonPassword').value;
            var firstName = document.getElementById('editLogonFName').value;
            var lastName = document.getElementById('editLogonLName').value;
            var emailAddress = document.getElementById('editLogonEmail').value;
            var secQuestion = document.getElementById('editSecQuestion').value;
            var secAnswer = document.getElementById('editSecAnswer').value;
            var isadmin = document.getElementById('editAdmin').value;

            if (isadmin == 'Yes') {
                isadmin = 1;
            }
            else { isadmin = 2; }

            var webMethod = "ProjectServices.asmx/UpdateAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\",\"firstName\":\"" + encodeURI(firstName) + "\",\"lastName\":\"" + encodeURI(lastName) + "\",\"userName\":\"" + encodeURI(userName) +
                "\",\"emailAddress\":\"" + encodeURI(emailAddress) + "\",\"pwd\":\"" + encodeURI(pwd) + "\",\"secQuestion\":\"" + encodeURI(secQuestion) +
                "\",\"secAnswer\":\"" + encodeURI(secAnswer) + "\",\"admin\":\"" + encodeURI(isadmin) + "\"}";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert('This account has been updated.')

                },
                error: function (err) {
                    alert("An error has occurred.");
                }
            });

        }


        //This function shows the admin menu
        function ShowMenu() {

            $("#adminPanel").css("visibility", "visible");
        }


        //just hides the admin menu
        function HideMenu() {

            $("#adminPanel").css("visibility", "hidden");
            $("#adminLink").text("");
        }

        // show/hide password
        function ShowPassword() {
            var x = document.getElementById("editLogonPassword");
            if (x.type === "password") {
                x.type = "text";
            } else {
                x.type = "password";
            }
        }


    </script>
    <!--END OF YOUR OWN JAVASCRIPT-->

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            font-family: Arial;
        }

        body {
            height: 100vh;
            width: 100vw;
            background-color: #8C1D40;
        }

        .homeBar {
            background: #FFC627;
            padding: 0;
            font-size: 26px;
            height: 15vh;
            width: 100vw;
            text-align: center;
        }

        .container {
            display: grid;
            grid-template-columns: 25vw 50vw 25vw;
            text-align: left;
        }

        h2 {
            text-align: left;
            font-weight: bold;
            color: white;
        }

        .SubmitPanel {
            padding: 10px;
            height: fit-content;
            margin: 10px 0 0 10px;
            background-color: #FFC627;
            border: solid white 1px;
        }

        #filterPanel {
            padding: 10px;
            height: fit-content;
            margin: 10px 10px 0 10px;
            background-color: #FFC627;
            border: solid white 1px;
        }

        #adminPanel {
            padding: 10px;
            height: fit-content;
            margin: 10px 10px 0 10px;
            background-color: #FFC627;
            border: solid white 1px;
        }

        .contentPanel {
            padding: 10px;
            height: fit-content;
        }

        #suggestionsPanel {
            margin-top: 10px;
            margin-left: 10px;
        }

        .suggestionRow {
            height: fit-content;
            padding: 2vh;
            margin-bottom: 2vh;
            background-color: #FFC627;
        }

        form {
            padding: 10px;
            background: #FFC627;
        }

        #category {
            width: 20vw;
            border: none;
        }

        #desc {
            width: 20vw;
            height: 35vh;
            resize: none;
            border: none;
        }

        .label {
            background-color: #FFC627;
            font-weight: bold;
        }

        hr {
            border: 1px solid white;
            margin: 5px 0;
        }

        #topPost {
            background: #FFF;
            color: #8C1D40;
            font: bold 20px Arial;
            padding: 3px;
            width: 130px;
            border: 6px ridge #FFC627;
            border-right: 6px groove #FFC627;
            border-bottom: 2px groove #FFC627;
            text-align: center;
        }

        .postCat {
            float: right;
            background: #FFF;
            padding: 8px;
            border-radius: 10px;
            width: 150px;
            text-align: center;
            font-weight: bold;
            font-size: 13px;
        }

        .postDetails {
            font-size: 16px;
        }

        .upvote {
            background-color: #FFC627;
            color: #8C1D40;
            padding: 0px;
            font-size: 200%;
            font-weight: bold;
            margin: 0;
            border-radius: 10px;
        }

        button {
            background: #8C1D40;
            color: white;
            border: none;
            padding: 1vh;
            margin: 0;
            cursor: pointer;
        }

        #newPost {
            background: #FFF;
            padding: 15px;
            margin-bottom: 5px;
            font-weight: bold;
            text-align: center;
        }

        .postLikes {
        }



        /* Styling for the edit suggestion pop-up box*/
        /* Button used to open the contact form - fixed at the bottom of the page */

        /* The popup form - hidden by default */
        .form-popup {
            display: none;
            position: fixed;
            top: 130px;
            right: 10px;
            border: 3px solid black;
            z-index: 9;
        }

        /* Add styles to the form container */
        .form-container {
            max-width: 275px;
            padding: 10px;
            background-color: floralwhite;
        }

        /* Full-width input fields */
        .form-container input[type=text], .form-container input[type=password] {
            width: 100%;
            padding: 15px;
            margin: 5px 0 22px 0;
            border: none;
            background: #f1f1f1;
        }

        /* When the inputs get focus, do something */
        .form-container input[type=text]:focus, .form-container input[type=password]:focus {
            background-color: #ddd;
            outline: none;
        }

        /* Set a style for the submit/login button */
        .form-container .btn {
            background-color: #04AA6D;
            color: white;
            padding: 16px 20px;
            border: none;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        /* Add a red background color to the cancel button */
        .form-container .cancel {
            background-color: red;
        }

        /* Add some hover effects to buttons */
        .form-container .btn:hover, .open-button:hover {
            opacity: 1;
        }

        .popUpLabel {
            background-color: #FFC627;
            font-weight: bold;
        }



    </style>
</head>

<body onload="LoadSuggestions(); CheckAdmin();">
    <header class="homeBar">
        <h1>Devil's Suggestion</h1>
        <a href="#" onclick="LogOff()">Log Off</a>
    </header>

    <div class="container">
        <div class="SubmitPanel">
            <div id="newPost">Create New Post</div>
            <form onsubmit="NewSuggestion($('#desc').val() , $('#category').val()); return false;">
                <label class="label">Category of Suggestion:</label><br>
                <select name="category" id="category">
                    <option value="Money">Money</option>
                    <option value="HR">HR</option>
                    <option value="Employee">Employee</option>
                    <option value="Hours">Working Hours</option>
                    <option value="Other">Other</option>
                </select>
                <br><br>
                <label class="label">Suggestion Details:</label><br>
                <textarea name="desc" id="desc" maxlength="500" required></textarea>
                <br><br>
                <button type="submit" id="submit">Submit Suggestion</button>
            </form>
        </div>

        <main id="suggestionsPanel" class="contentPanel">
            <h2 id="middlePanelTitle"> Current Suggestions</h2><hr>
            <h3 id="topPost">Top Post</h3>
            <section class="suggestionsBox" id="suggestionsBox"></section>
            <section class="editAccountPanel" id="editAccountPanel" style="visibility:hidden">
                <div id="editAccountPanel">
                    <form>
                        <table>
                            <tr>
                                <td>
                                    User Name:
                                </td>
                                <td>
                                    <input type="text" id="editLogonId" />
                                </td>
                                <td>
                                    <input type="text" id="accountID" style="visibility:hidden;" />
                                </td>
                            </tr>
                            <tr>
                                <td>Password:</td>
                                <td><input type="password" id="editLogonPassword" minlength="10" /> </td>
                                <td><label for="show">Show Password</label><input style="margin-left:3px;" type="checkbox" onclick="ShowPassword()" /></td>
                            </tr>
                            <tr>
                                <td>First Name:</td>
                                <td><input type="text" id="editLogonFName" /></td>
                            </tr>
                            <tr>
                                <td>Last Name:</td>
                                <td><input type="text" id="editLogonLName" /></td>
                            </tr>
                            <tr>
                                <td>Email Address:</td>
                                <td><input type="text" id="editLogonEmail" /></td>
                            </tr>
                            <tr>
                                <td>Security Question:</td>
                                <td><input type="text" id="currentSecQ" /></td>
                                <td>
                                    <select id="editSecQuestion" placeholder="Choose a security question" required>
                                        <option disabled selected> -- Select a Security Question -- </option>
                                        <option value="Pie or Cake?">Pie or Cake?</option>
                                        <option value="Favorite Number between 1-100">Favorite Number between 1-100</option>
                                        <option value="Favorite Color">Favorite Color</option>
                                        <option value="Are you a Cop? Don't lie">Are you a Cop? Don't lie</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Security Answer:</td>
                                <td><input type="text" id="editSecAnswer" /></td>
                            </tr>
                            <tr>
                                <td>
                                    Admin:
                                </td>
                                <td><input type="text" id="editAdmin" /></td>
                            </tr>
                            <tr>
                                <td>
                                    LockedOut?
                                </td>
                                <td><input type="text" id="editLockedOut" /></td>
                                <td><button onclick="UnlockAccount();">Unlock</button></td>
                            </tr>
                            <tr>
                                <td><button onclick="UpdateAccount();">Save</button></td>
                                <td><a href="javascript:void(0);" onclick="LoadAccounts(); ShowPassword();" style="float:right;">Return</a></td>
                            </tr>
                        </table>
                    </form>

                </div>
            </section>
        </main>

        <div class="adminContainer">
            <section id="filterPanel">
                <h4><u>Filters</u></h4><br />
                <a href="#" id="filterLink" onclick="FilterSuggestions('Employee')">Employees Suggestions</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('Hours')">Hours Suggestions</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('HR')">HR Suggestions</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('Other')">Other Suggestions</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('Evaluating')">Suggestions in Evaluation</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('In Progress')">Suggestions In Progress</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('Completed')">Completed Suggestionss</a><br>
                <a href="#" id="filterLink" onclick="FilterSuggestions('All')">Show All Suggestions</a><br>
            </section>

            <section id="adminPanel" style="visibility: hidden">
                <a href="#" id="suggestionsLink" onclick="LoadUnapprovedSuggestions()">Review Suggesion Requests</a><br>
                <a href="#" id="suggestionsLink" onclick="ManageSuggestions()">Manage Suggesions</a><br>
                <a href="#" id="suggestionsLink" onclick="LoadUnapprovedAccounts()">Review Account Requests</a><br>
                <a href="#" id="suggestionsLink" onclick="LoadAccounts()">Manage Accounts</a><br><br>
                <a href="#" id="suggestionsLink" onclick="LoadSuggestions()">Home</a><br><br>
                <!--<h2>Current Unapproved Suggestions</h2><hr>
            <section class="unapprovedSuggestionsBox" id="unapprovedSuggestionsBox"></section>-->
            </section>
        </div>
        <!--This section is for the edit suggestion pop-up box-->
        <div class="form-popup" id="myForm">
            <form class="form-container"onsubmit="SaveEdits($('#editDesc').val() , $('#editCategory').val(), $('#editStatus').val(), postID); return false;" >
                <h1>Edit Suggestion</h1>

                <label class="popUpLabel">Category of Suggestion:</label><br>
                <select name="editCategory" id="editCategory">
                    <option value="Money">Money</option>
                    <option value="HR">HR</option>
                    <option value="Employee">Employee</option>
                    <option value="Hours">Working Hours</option>
                    <option value="Other">Other</option>
                </select><br />

                <label class="popUpLabel">Status of Sugegstion:</label><br>
                <select name="editStatus" id="editStatus">
                    <option value="Evaluating">Evaluating</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Completed">Completed</option>
                </select><br />

                <label class="popUpLabel"><b>Desctiption of Suggestion</b></label>
                <input type="text" placeholder="Description" name="editDesc" id="editDesc">

                <button type="submit" class="btn">Save Edits</button>
                <button type="button" class="btn cancel" onclick="CloseForm()">Cancel</button>
            </form>
        </div>

    </div>
    </body>
    </html>
